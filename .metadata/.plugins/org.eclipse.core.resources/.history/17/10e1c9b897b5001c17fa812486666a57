package com.demiroren.config;

import org.modelmapper.Converter;
import org.modelmapper.ModelMapper;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.demiroren.Entity.Contact;
import com.demiroren.Entity.Phone;
import com.demiroren.dto.request.AddContactRequest;

/**
 * @author Remzi ÅžAHBAZ
 *
 */
@Configuration
public class ModelMapperConfiguration {

	public static final Converter<AddContactRequest, Contact> AddContactRequest_To_Contact = (context) -> {

		var contact = context.getDestination();
		var request = context.getSource();

		contact.setLastName(request.getLastName());
		contact.setName(request.getName());
		var phones = request.getPhone()
						.stream()
						.map(p->{
							
							var phone= new Phone();
							phone.setValue(p.getValue());
							return phone;
						})
						.toList();
		contact.setPhone(phones);
		return contact;
	};

	@Bean
	public ModelMapper mapper() {
		
		var mapper= new ModelMapper();
		mapper.addConverter(AddContactRequest_To_Contact);
		return mapper;
	}
}
